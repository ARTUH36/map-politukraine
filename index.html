<!DOCTYPE html>
<html>
<head>
  <title>–ö–∞—Ä—Ç–∞ (—Ç—ñ–ª—å–∫–∏ –ø–µ—Ä–µ–≥–ª—è–¥)</title>
  <meta charset="utf-8" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    #map { width: 100%; height: 600px; }
  </style>
</head>
<body>
  <div id="map"></div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    const imageWidth = 6460;
    const imageHeight = 3403;

    const map = L.map('map', {
      crs: L.CRS.Simple,
      minZoom: 0,
      maxZoom: 5,
      zoomControl: true
    });

    const bounds = [[0, 0], [imageHeight, imageWidth]];
    const image = L.imageOverlay('your_image.png', bounds).addTo(map);
    map.setView([1900, 4000], 2.8); // –¶–µ –ø—Ä–∏–±–ª–∏–∑–Ω–æ –¥–µ—Å—å –Ω–∞–¥ –£–∫—Ä–∞—ó–Ω–æ—é


    const drawnItems = new L.FeatureGroup();
    map.addLayer(drawnItems);

    function loadGeoJSON(geojson) {
      drawnItems.clearLayers();

      L.geoJSON(geojson, {
        pointToLayer: function(feature, latlng) {
          if (feature.properties.type === "marker") {
            const icon = L.icon({
              iconUrl: feature.properties.icon,
              iconSize: [32, 20],
              iconAnchor: [16, 10],
              popupAnchor: [0, -10]
            });

            const marker = L.marker(latlng, { icon: icon });
            marker.feature = feature;

            marker.bindPopup("üè≥Ô∏è <b>" + (feature.properties.occupier || '–ù–µ–≤—ñ–¥–æ–º–æ') + "</b>");
            drawnItems.addLayer(marker);
            return marker;
          }
          return L.marker(latlng);
        },
        onEachFeature: function(feature, layer) {
          if (feature.geometry.type === "Polygon") {
            const color = feature.properties.color || '#0077ff';
            layer.setStyle({
              color: color,
              fillOpacity: 0.4
            });

            layer.bindPopup("üó∫Ô∏è <b>" + feature.properties.name + "</b><br>üö© –û–∫—É–ø–∞–Ω—Ç: <b>" + feature.properties.occupier + "</b>");
            drawnItems.addLayer(layer);
          }
        }
      });
    }

    // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç—ñ
    window.addEventListener('load', () => {
      fetch('zones_and_flags.json')
        .then(response => {
          if (!response.ok) {
            throw new Error(`–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ñ–∞–π–ª: ${response.status} ${response.statusText}`);
          }
          return response.json();
        })
        .then(data => loadGeoJSON(data))
        .catch(error => {
          console.error("–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ GeoJSON:", error);
          alert("‚ö†Ô∏è –ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∑–æ–Ω–∏ —Ç–∞ –ø—Ä–∞–ø–æ—Ä–∏ –∑ —Ñ–∞–π–ª—É 'zones_and_flags.json'.");
        });
    });
  </script>
</body>
</html>
